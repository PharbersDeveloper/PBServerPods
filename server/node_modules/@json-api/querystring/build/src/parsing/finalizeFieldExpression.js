"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const helpers_1 = require("../helpers");
function finalizeFieldExpression(operators, it) {
    if (!(it.operator in operators)) {
        throw new SyntaxError(`"${it.operator}" is not a recognized operator.`);
    }
    const finalArgs = operators[it.operator].finalizeArgs(operators, it.operator, it.args.map((arg) => {
        return helpers_1.isFieldExpression(arg)
            ? finalizeFieldExpression(operators, arg)
            : arg;
    }));
    const expectedArity = operators[it.operator].arity;
    if (expectedArity !== Infinity && finalArgs.length !== expectedArity) {
        throw new SyntaxError(`"${it.operator}" operator expects exactly ${expectedArity} arguments; ` +
            `got ${finalArgs.length}.`);
    }
    return Object.assign({}, it, { args: finalArgs });
}
exports.default = finalizeFieldExpression;
